<div class="content" ng-controller="accountReceivableController" ng-init="initialize()">
<div class="content-header">
    <h2 class = "content-Info">Billing</h2>
</div><!--/content-header -->

<div class="content-body">

    <script>var locs = [["51.38254", "-2.362804"], ["51.235249", "-2.297804"], ["51.086126", "-2.210767"], ["51.084519", "-2.262813"], ["51.175994", "-2.159207"], ["51.132978", "-2.213939"], ["51.207289", "-2.181474"], ["51.321724", "-2.205518"], ["51.317219", "-2.210649"], ["50.700816", "-1.925721"], ["50.719979", "-2.074488"], ["50.810063", "-1.919034"], ["50.785094", "-1.849725"], ["50.842648", "-1.777575"], ["50.723047", "-1.902297"], ["50.743044", "-1.880132"], ["51.71355, 0.154967"], ["51.992676, 0.602668"], ["52.355964", "-1.486877"], ["53.523356", "-1.107254"], ["51.87591", "-2.235986"], ["51.670729", "-1.934476"], ["51.542953", "-0.28102"], ["51.52132, 0.098986"], ["52.271354, 0.788806"], ["51.346031", "-0.478255"], ["51.263343", "-1.140235"], ["51.481736", "-1.089953"], ["51.476566", "-0.514911"], ["51.505462", "-0.555614"], ["51.558631", "-1.78224"], ["51.351101", "-1.995069"], ["51.380722", "-2.039105"], ["51.416719", "-2.124294"], ["51.42063", "-2.133049"], ["51.533076", "-1.925663"], ["51.348518", "-1.797868"], ["51.331682", "-1.776469"], ["51.127299", "-1.568594"], ["51.082304", "-1.172732"], ["50.994651", "-1.495699"], ["50.988355", "-1.499401"], ["51.074562", "-1.774168"], ["51.066228", "-1.799655"], ["51.071929", "-1.794634"], ["51.218585", "-1.515494"], ["51.080011", "-1.860008"], ["5151.070508", "-1.810412"], ["51.056581", "-1.795259"], ["51.043955", "-1.789822"], ["51.20323", "-1.906011"], ["51.229055", "-1.951243"], ["51.061094", "-1.998836"], ["51.039063", "-1.999079"], ["51.067313", "-2.070322"], ["51.099235", "-1.787773"], ["51.250454", "-1.764469"], ["51.006591", "-1.650057"], ["50.999451", "-2.080693"], ["50.993131", "-2.246465"], ["51.006542", "-2.197207"], ["51.01744", "-2.186619"], ["51.042629", "-2.272731"], ["51.007395", "-2.332772"], ["55.605281", "-2.899154"], ["53.395123", "-2.537949"], ["53.684928", "-1.511449"]];

function initMap() {
  var myLatLng = {lat: 51.38254, lng: -2.362804};

  var map = new google.maps.Map(document.getElementById('map'), {
    zoom: 4,
    center: myLatLng
  });

  var marker, i;
  for (i = 0; i < locs.length; i++) {  
  marker = new google.maps.Marker({
    position: new google.maps.LatLng(locs[i][0], locs[i][1]),
    icon: {
      path: google.maps.SymbolPath.CIRCLE,
      scale: 1,
    },
    map: map
  });
}
}

      $('#centerModal').on('shown', function () {
    google.maps.event.trigger(map, "resize");
    });

      $("#centerModal").on("shown.bs.modal", function () {
    google.maps.event.trigger(map, "resize");
});





    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBmLSdPHWhBxW4fbHju5j93BQjwtb_xAkw&callback=initMap"
    async defer></script>



  <div id="error-placement" class="text-center"><span style="color:white">hi</span>{{errorMessage}}</div>

   
  <div class="col-md-14 margin-bottom">
            <ul class="nav nav-tabs">
                <li ng-class="{ 'active': invoiceType == invoiceTypes.created.value+','+
                invoiceTypes.submitted.value+','+
                invoiceTypes.approved.value+','+
                invoiceTypes.paid.value+','+
                invoiceTypes.archieved.value }"><a ui-sref="accountReceivable.invoice({invoiceType:'ALL',message : ''})" data-toggle="tab">All</a></li>
                <li ng-class="{ 'active': invoiceType == invoiceTypes.submitted.value }"><a ui-sref="accountReceivable.invoice({invoiceType : invoiceTypes.submitted.value,message : ''})" data-toggle="tab">Submitted</a></li>
                <li ng-class="{ 'active': invoiceType == invoiceTypes.approved.value }"><a ui-sref="accountReceivable.invoice({invoiceType : invoiceTypes.approved.value,message : ''})">Approved</a></li>
                <li ng-class="{ 'active': invoiceType == invoiceTypes.paid.value }"><a ui-sref="accountReceivable.invoice({invoiceType : invoiceTypes.paid.value,message : ''})">Paid</a></li>
                <button ng-show="{{submitAllInvoiceList.length != 0}}" ng-click="submitAllInvoice()" type="button" style ="float:right;width: 110px" class="btn btn-primary">Submit All</button>
            </ul>

  </div>

    <div class="table-responsive">
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>Job ID #</th>
                    <th>Location</th>
                    <th>InvoiceAmount</th>
                    <th>Time Completed</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody ng-repeat="item in jobInvoiceTripList">
                <tr>
                    <td class ="stylingFonts">{{item.job.name}}</td>
                    <td>{{item.job.area}}</td>
                    <td><i class="fa fa-inr"></i>{{item.invoice.total_amount}}</td>
                    <td>{{item.job.latest_state.time | date: 'MM/dd/yyyy h:mma'}}</td>
                    <td ng-click="submitInvoice(item)" ng-show="{{item.invoice.status == invoiceTypes.created.value}}" class ="stylingFonts">Submit Invoice</td>
                    <td ng-show="{{item.invoice.status == invoiceTypes.submitted.value}}" class ="">Pending Approval</td>
                    <td ng-show="{{item.invoice.status == invoiceTypes.approved.value}}" class ="">Pending Payment</td>
                    <td ng-show="{{item.invoice.status == invoiceTypes.paid.value}}" class ="">Paid</td>
                    <td ng-show="{{item.invoice.status == invoiceTypes.archieved.value}}" class ="">Archieved</td>
                </tr>
            </tbody>
        </table>
    </div>

    <button ng-show="false" type="button" class="btn btn-default" data-toggle="modal" data-target="#centerModal">Show modal</button>
    
    <div class="modal fade" data-sound="note" id="centerModal" tabindex="-1" role="dialog" aria-labelledby="centerModalLabel" aria-hidden="true">
    <div class="modal-dialog animated flipInX modalMedia" style ="width:61%; margin: 4% auto">
    <div class="modal-content">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            <h4 class="modal-title" id="centerModalLabel">Invoice For Job ID# {{invoiceTobeSubmitted.job.name}}</h4>
      </div>
        <div class="modal-body">
            

            <div class="clearfix row">

            <div class ="col-md-4">
                <div class = "innerWrapper">
                    <div class = "driver_image"></div>
                    <div class="fontCover">
                    <div class ="text_1" style ="line-height: 11px;">
                      <p class ="fontDesign">{{invoiceTobeSubmitted.contractTask.driver_name}}</p>
                     
                    </div>
                    <div class ="text_1" style ="line-height: 11px;">
                       <p class ="fontDrama" style ="float:left">{{invoiceTobeSubmitted.contractTask.provider_name}}</p> 
                       
                    </div>
                    </div>
                    <div class="fontCover">
                    <div class ="text_1" style ="line-height: 11px;">
                      <p class ="fontDesign">{{invoiceTobeSubmitted.contractTask.vehicle_regNumber}}</p>
                     
                    </div>
                    <div class ="text_1" style ="line-height: 11px;">
                       <p class ="fontDrama" style ="float:left">{{invoiceTobeSubmitted.contractTask.vehicle_make}}</p> 
                       
                    </div>
                    </div>
                    
                </div>    
            </div>
            <div class ="col-md-4">
                <div class = "innerWrapper">
                    <div id="map" style="height:200px;"></div>
                    <div class="fontCover">
                    <div class ="text_1" style ="line-height: 11px;">
                      <p class ="fontDesign">{{invoiceTobeSubmitted.job.name}}</p>
                     
                    </div>
                    <div class ="text_1" style ="line-height: 11px;">
                       <p class ="fontDrama" style ="float:left">{{invoiceTobeSubmitted.job.area}}</p> 
                       
                    </div>
                    </div>
                    <div class="fontCover">
                    <div class ="text_1" style ="line-height: 11px;height: 56px;">
                      <p class ="fontDesign">{{invoiceTobeSubmitted.job.number_of_packages}} Packages</p>
                     
                    </div>
                    </div>
                    
                </div>    
            </div>
            <div class ="col-md-4">
                <div class = "innerWrapper">
                    <div class ="TopBar" style ="height:200px">
                        <p style ="position: relative;top: 83px;"><i class="fa fa-inr"></i> {{invoiceTobeSubmitted.invoice.total_amount}}</p>
                    </div>
                    <div class="fontCover" style ="height:58px">
                    <div class ="text_1" style ="line-height: 11px;">
                      <p class ="fontDesign pull-left">Trip Start</p>
                     
                    </div>
                    <div class ="text_1" style ="line-height: 11px;">
                       <div class ="fontDrama" style ="float:right;" >{{invoiceTobeApproved.tripStates[0].odometer != undefined ? invoiceTobeApproved.tripStates[0].odometer : '--'}}</div>
                       <div class ="fontDrama" style ="float:right;" >{{ invoiceTobeApproved.tripStates[0].time != undefined ? (invoiceTobeApproved.tripStates[0].time  | date: 'h:mma') : '--'}}</div>
                       
                    </div>
                    </div>
                    <div class="fontCover" style ="height:58px">
                    <div class ="text_1" style ="line-height: 11px;">
                      <p class ="fontDesign pull-left">Trip End</p>
                     
                    </div>
                    <div class ="text_1" style ="line-height: 11px;">
                       <div class ="fontDrama" style ="float:right">{{invoiceTobeApproved.tripStates[1].odometer != undefined ? invoiceTobeApproved.tripStates[1].odometer : '--'}}</div> 
                       <div class ="fontDrama" style ="float:right">{{invoiceTobeApproved.tripState[1].time != undefined ? (invoiceTobeApproved.tripState[1].time  | date: 'h:mma') : '--' }}</div>
                    </div>
                    </div>
                    
                </div>    
            </div>


            </div>


        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            <button ng-click="submitModalInvoice()" type="button" style ="float:right;width: 110px" class="btn btn-primary">Submit</button>
        </div>
    </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
    </div><!-- /.modal -->

   
</div> <!-- content-body -->



